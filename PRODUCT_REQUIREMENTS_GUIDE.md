# 产品需求文档使用指南
# Product Requirements Guide

**版本**: 1.0  
**适用对象**: 产品经理、业务分析师、需求分析师  
**目标**: 帮助规范化地编写模块化功能需求，便于AI代码生成  

---

## 🎯 文档目标 (Document Objectives)

### 💡 为什么需要这个模板？
1. **标准化需求描述** - 确保所有功能需求格式统一、信息完整
2. **便于AI理解** - 结构化的需求便于AI准确理解并生成代码
3. **提高开发效率** - 减少需求澄清时间，加速开发流程
4. **确保质量** - 强制包含测试场景和验收标准

### 🏗️ 基于模块化架构
- 每个需求对应一个独立的功能模块
- 遵循RST AI Core严格的模块开发规范
- 支持模块间清晰的依赖关系定义
- 确保代码的可维护性和扩展性

---

## 📋 模板使用说明 (Template Usage Guide)

### 🚀 快速开始步骤

#### 1️⃣ **复制模板**
```bash
# 为新需求创建文档
cp PRODUCT_REQUIREMENTS_TEMPLATE.md requirements/REQ-2024-MMDD-XXX.md
```

#### 2️⃣ **填写基本信息**
- 确定需求名称（中英文）
- 分配唯一需求编号
- 设置优先级和时间计划
- 指定负责人

#### 3️⃣ **设计模块**
- 选择模块名称（英文，小写+下划线）
- 分析依赖关系
- 确定模块类型（CRUDModule推荐）

#### 4️⃣ **定义数据模型**
- 设计主要业务实体
- 定义字段和验证规则
- 建立实体间关系

#### 5️⃣ **设计API**
- 确定需要的CRUD端点
- 设计自定义业务端点
- 定义权限控制规则

---

## 📝 各章节填写指南 (Section Guidelines)

### 🏷️ 需求基本信息
```yaml
填写要点:
  需求名称: 
    - 用简洁的中文描述功能
    - 例如: "用户评论管理"、"订单状态跟踪"
    
  需求编号:
    - 格式: REQ-YYYY-MMDD-XXX
    - 例如: REQ-2024-1013-001
    
  优先级:
    - 高: 核心业务功能，必须优先实现
    - 中: 重要功能，计划内实现
    - 低: 增值功能，资源允许时实现
    
  需求描述:
    - 从用户角度描述问题和价值
    - 说明业务背景和使用场景
    - 避免技术实现细节
```

### 🏗️ 模块设计信息
```yaml
模块命名规范:
  英文名称:
    - 使用小写字母和下划线
    - 体现业务含义
    - 例如: user_comments, order_tracking, product_reviews
    
  依赖分析:
    - core: 几乎所有模块都需要（用户认证等）
    - 业务依赖: 明确列出相关的其他模块
    - 外部依赖: 第三方服务或库
    
  模块类型选择:
    - CRUDModule: 标准的增删改查功能（推荐）
    - BaseModule: 需要完全自定义的功能
```

### 🗃️ 数据模型设计
```yaml
实体设计原则:
  字段设计:
    - 明确字段类型和长度
    - 设置合理的默认值
    - 定义必填和可选字段
    - 考虑业务规则约束
    
  关联关系:
    - 明确一对一、一对多、多对多关系
    - 设置正确的外键和级联删除
    - 考虑查询性能和数据完整性
    
  命名规范:
    - 实体名称使用PascalCase
    - 字段名称使用snake_case
    - 表名使用复数形式
```

### 🛣️ API端点设计
```yaml
端点设计原则:
  标准CRUD:
    - 优先使用CRUDModule自动生成
    - 遵循RESTful API规范
    - 统一返回格式 {data: [...], count: ...}
    
  自定义端点:
    - 明确业务价值
    - 设计清晰的URL结构
    - 定义完整的请求/响应格式
    
  权限设计:
    - 最小权限原则
    - 明确区分游客、用户、管理员权限
    - 考虑数据所有权检查
```

### 🧪 测试场景设计
```yaml
测试用例原则:
  功能测试:
    - 正常流程测试
    - 异常情况处理
    - 边界条件验证
    - 权限边界测试
    
  数据测试:
    - 数据验证规则
    - 数据完整性约束
    - 并发操作安全性
    
  性能测试:
    - 响应时间要求
    - 并发用户数
    - 数据量压力测试
```

---

## 💡 最佳实践 (Best Practices)

### ✅ 推荐做法

#### 📋 需求分析
- **从用户角度出发** - 描述用户需要解决的问题
- **业务价值导向** - 明确功能的商业价值
- **场景驱动设计** - 基于具体使用场景设计功能

#### 🎯 模块设计
- **单一职责原则** - 每个模块只负责一个业务领域
- **低耦合高内聚** - 最小化模块间依赖
- **可扩展设计** - 预留未来功能扩展空间

#### 📊 数据建模
- **业务实体优先** - 从业务概念建模，不是技术实现
- **规范化设计** - 避免数据冗余，确保一致性
- **性能考虑** - 合理设置索引和查询优化

#### 🔐 安全设计
- **权限最小化** - 只给必要的权限
- **数据隔离** - 用户只能访问自己的数据
- **输入验证** - 所有外部输入都要验证

### ❌ 常见错误

#### 🚫 需求描述错误
- 过于技术化的描述
- 缺乏业务背景说明
- 需求范围过大或过小
- 缺少验收标准

#### 🚫 设计问题
- 模块职责不清晰
- 数据模型过度复杂
- API设计不符合RESTful规范
- 忽略权限和安全考虑

---

## 🛠️ 工具和辅助 (Tools & Assistance)

### 📝 需求检查清单
```yaml
提交前检查:
  基本信息: 
    - [ ] 需求编号唯一
    - [ ] 优先级和时间合理
    - [ ] 负责人明确
    
  功能设计:
    - [ ] 模块名称符合规范
    - [ ] 依赖关系明确
    - [ ] 数据模型完整
    - [ ] API设计合理
    
  质量保证:
    - [ ] 测试场景完整
    - [ ] 验收标准明确
    - [ ] 风险评估充分
    - [ ] 配置参数合理
```

### 🔍 常用参考

#### 数据类型参考
```yaml
常用字段类型:
  文本类型:
    - str: 短文本 (< 255字符)
    - text: 长文本 (> 255字符)
    - email: 邮箱地址
    - url: 网址链接
    
  数值类型:
    - int: 整数
    - float: 浮点数
    - decimal: 精确小数 (金额等)
    
  时间类型:
    - datetime: 日期时间
    - date: 日期
    - time: 时间
    
  其他类型:
    - bool: 布尔值
    - uuid: 唯一标识符
    - json: JSON数据
```

#### 权限级别参考
```yaml
权限级别:
  public: 公开访问，无需认证
  authenticated: 需要登录
  owner: 数据所有者
  admin: 管理员
  superuser: 超级管理员
```

---

## 🎯 AI代码生成优化建议

### 🤖 让AI更好理解需求

#### 📝 结构化描述
- 使用YAML格式描述复杂配置
- 用表格形式展示字段定义
- 采用清晰的分层结构
- 提供具体的示例数据

#### 🎯 明确性要求
- 避免模糊的表述如"适当的"、"合理的"
- 使用具体的数值范围和枚举值
- 明确指定验证规则和约束条件
- 提供完整的业务规则描述

#### 🔗 关联性说明
- 明确模块间的依赖关系
- 描述数据实体间的关联
- 说明业务流程的前后关系
- 定义状态流转规则

---

## 📞 支持和反馈 (Support & Feedback)

### 🆘 获取帮助
- **模板问题**: 查看 `MODULES_DEVELOPMENT_GUIDE.md`
- **技术规范**: 参考 `.cursor/rules/rst-ai-core-modules-rules.mdc`
- **示例参考**: 查看现有模块实现 (`backend/app/modules/`)

### 📝 持续改进
- 收集使用反馈
- 优化模板结构
- 补充最佳实践
- 更新工具支持

---

**记住**: 好的需求文档是高质量代码的基础！花时间写清楚需求，能够大大提高开发效率和代码质量。

---

*本指南基于 RST AI Core 模块开发规范创建*  
*指南版本: 1.0*
